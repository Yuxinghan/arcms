#set($layout = "/layout/blank.vm")
<!-- 百度 文本编辑器 -->
<div id="web">
    <div class="row">
        <div class="col-xs-12">
            <div class="table-responsive">
                <div class="BoxStyleA">
                    <div class="breadcrumbs" id="breadcrumbs">
                        <i class="modal-logo interact"></i>
                        <ul class="breadcrumb" style="margin-left: 2px">
                            <li></li>
                            <li>商家管理</li>
                            <li>商品管理</li>
                            <li class="active">修改商品</li>
                        </ul>
                        <!-- .breadcrumb -->
                    </div>
                </div>
                <div>&nbsp;</div>
                <div class="BoxStyleA">
                    <br/>

                    <form class="form-horizontal" role="form" method="post" enctype="multipart/form-data" id="uf"
                          action="${rc.contextPath}/upload">
                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1">商品标题(<font
                                    color="red">*</font>)：</label>

                            <div class="col-sm-9">
                                <input type="hidden" name="goodsId" value="${goods.goodsId}"/>
                                <input type="text" id="goodsName" placeholder="" class="col-xs-12 col-sm-7"
                                       name="goodsName" class="required" value="${goods.title}"/>
                            </div>
                            <div class="Validform_checktip"></div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1">商品简介(<font
                                    color="red">*</font>)：</label>

                            <div class="col-sm-9">
                                <input type="text" id="goodsSummary" placeholder="" class="col-xs-12 col-sm-7"
                                       name="goodsSummary" class="required"  value="${goods.goodsSummary}"/>
                            </div>
                            <div class="Validform_checktip"></div>
                        </div>
                        <div class="space-4"></div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-2">商品分类(<font
                                    color="red">*</font>)：</label>

                            <div class="col-sm-9" style="text-align: left">
                                <select name="category">
                                    <option value="">请选择</option>
                                    #foreach($category in $goodsCategoryList)
                                        <option value="$category.cid" #if(${goods.cid} == ${category.cid}) selected #end>$category.name</option>
                                    #end
                                </select>
                            </div>
                        </div>
                        <div class="space-4"></div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1">商品类型(<font
                                    color="red">*</font>)：</label>

                            <div class="col-sm-9" style="text-align: left">

                                <input type="radio" class="ace" value="1" name="goodsType" #if($goods.isVirtual) checked="checked" #end/>
                                <span class="lbl">虚拟(无需发货)</span>
                                &nbsp;&nbsp;
                                <input type="radio" class="ace" value="0" name="goodsType" #if(!$goods.isVirtual) checked="checked" #end/>
                                <span class="lbl">实物(物流发货)</span>

                            </div>
                        </div>
                    ##                    <div class="form-group">
                    ##                        <label class="col-sm-3 control-label no-padding-right" for="form-field-1">商品设置：</label>
                    ##                        <div class="col-sm-9" style="text-align: left;" id="p_prop">
                    ##                            请选择商品分类
                    ##                        </div>
                    ##                    </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1">商品总数量(<font
                                    color="red">*</font>)：</label>

                            <div class="col-sm-9" style="text-align: left">
                                <input class="input-sm" type="text" placeholder="" name="goodsAmount" id="goodsAmount" value="$goods.quantity"
                                       style="width: 80px"
                                       onblur="checkQuantityById('goodsAmount','amount_err_msg');return;"/>
                                <span id="amount_err_msg" style="color: red"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1">商品价格(<font
                                    color="red">*</font>)：</label>

                            <div class="col-sm-9" style="text-align: left">
                                <input class="input-sm" type="text" placeholder="" name="goodsPrice" id="goodsPrice" value="$goods.price"
                                       style="width: 80px"
                                       onblur="checkPriceById('goodsPrice','price_err_msg');return;"/>
                                <span class="lbl">元</span>
                                <span id="price_err_msg" style="color: red"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1">商品现价(<font
                                    color="red">*</font>)：</label>

                            <div class="col-sm-9" style="text-align: left">
                                <input class="input-sm" type="text" placeholder="" name="goodsNowPrice" id="goodsNowPrice" value="$goods.nowPrice"
                                       style="width: 80px" onblur=""/>
##                                <span class="lbl">元</span>
                                <span id="discount_err_msg" style="color: red"></span>
                            </div>
                        </div>
                        <div class="form-group" style="margin-bottom: 40px;">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1">商品缩略图(<font
                                    color="red">*</font>)：</label>

                            <div class="col-sm-9" style="text-align: left">
                                <div style="position: relative;float: left;width: 70px;height: 30px;text-align: center;border-radius: 2px;background-color: #428bca;">
                                    <a style="color: #fff;font-size: 14px;line-height: 30px;">选择</a>

                                    <div style="position: absolute;top:0;left:0;">
                                        <input type="file" name="thumbnail" id="thumbnail"
                                               style="width: 100px; height: 30px;background: rgb(255, 255, 255) none repeat scroll 0% 0%;filter:alpha(opacity:0);opacity: 0;"
                                               onchange="getName(this,'thumb');"/>
                                    </div>
                                </div>
                                <span class="thumb"
                                      style="display: block;float: left;margin-left: 5px;margin-top: 5px;"></span>
                                    <img src="$goods.thumbnail" width="42" height="35"/>
                                <span style="color: blue;position: absolute;top: 40px;left:10px;">图片规格: 220*150, 不超过1M, 支持jpg,jpeg,png,bmp,gif格式</span>
                            </div>
                        </div>

                        <div class="form-group" style="margin-bottom: 40px;">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1">商品图片(<font
                                    color="red">*</font>)：</label>

                            <div class="col-sm-9" style="text-align: left">
                                <div style="position: relative;float: left;width: 70px;height: 30px;text-align: center;border-radius: 2px;background-color: #428bca;">
                                    <a style="color: #fff;font-size: 14px;line-height: 30px;">选择</a>

                                    <div style="position: absolute;top:0;left:0;">
                                        <input type="file" name="photo1" id="photo1"
                                               style="width: 100px; height: 30px;background: rgb(255, 255, 255) none repeat scroll 0% 0%;filter:alpha(opacity:0);opacity: 0;"
                                               onchange="getName(this,'photo1');"/>
                                    </div>
                                </div>
                                <span class="photo1"
                                      style="display: block;float: left;margin-left: 5px;margin-top: 5px;"></span>
                                <img src="$goods.imgsUrl" width="42" height="35"/>

                                <span style="color: blue;position: absolute;top: 40px;left:10px;">图片规格: 750*425, 不超过2M, 支持jpg,jpeg,png,bmp,gif格式</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1">有效时间(<font
                                    color="red">*</font>)：</label>

                            <div class="col-sm-9" style="text-align: left">
                                <input type="text" name="startDate" onclick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss'})" value="$!dateTool.format("yyyy-MM-dd HH:mm:ss", ${goods.expiredStartTime})"/>
                                &nbsp;到&nbsp;
                                <input type="text" name="endDate" onclick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss'})" value="$!dateTool.format("yyyy-MM-dd HH:mm:ss", ${goods.expiredEndTime})"/>
                            </div>
                        </div>


                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1">选择套餐(<font color="red">*</font>)：</label>
                            <div class="col-sm-9" style="text-align: left">
                                <input type="button" style="float:left;display: block" class="btn_searchA" value="选择套餐" onclick="selectCombo()" />
                                <table border="1px" id="combo_tb">
                                    <tr>
                                    <td>套餐内容</td>
                                    <td>价格</td>
                                    <td>规格/数量</td>
                                    <td>小计</td>
                                    </tr>
                                    #foreach($combo in $comboVos)
                                        #set($all=$combo.price*$combo.quantity)
                                        <tr>
                                            <td>$combo.title</td>
                                            <td>$combo.price</td>
                                            <td>$combo.quantity</td>
                                            <td>$all</td>
                                        </tr>
                                    #end

                                </table>
                                <input type="hidden" name="comboIds" value="" id="comboIds" value="${goods.comboids}"/><br/>
                                <span id="poolid_err_msg" style="color: red"></span>
                            </div>
                        </div>


                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1">购买须知(<font
                                    color="red">*</font>)：</label>

                            <div class="col-sm-9" style="text-align: left">
                                <script id="purchaseNotesEditor" type="text/plain" style="width:90%; height:300px;"
                                        name="purchaseNotesEditor">${goods.notifyContent}</script>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1">图文详情(<font
                                    color="red">*</font>)：</label>

                            <div class="col-sm-9" style="text-align: left">
                                <script id="goodsDetailEditor" type="text/plain" style="width:90%; height:300px;"
                                        name="goodsDetailEditor">${goods.detailContent}</script>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1"></label>

                            <div class="col-sm-9" style="text-align: left">
                                <button class="btn btn-info" type="button" onclick="submitEditForm('uf');return false;">
                                    <i class="icon-ok bigger-110"></i>
                                    更新
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- 选择套餐 -->
<div class="modal fade" id="comboModal" tabindex="-1" role="dialog" aria-labelledby="comboModal" aria-hidden="true">
    <div class="modal-dialog" style="width: 1200px;z-index:-999px">
        <div class="modal-content" >
            <div class="tiptop"><span>套餐</span><a data-dismiss="modal" aria-hidden="true"></a></div>
            <div class="row">
                <div class="col-xs-12">
                    <div class="table-responsive">
                        <div class="BoxStyleA">
                            <div class="breadcrumbs" id="breadcrumbs">
                                <i class="modal-logo interact"></i>
                                <ul class="breadcrumb" style="margin-left: 2px">
                                    <li>
                                    <li>商家配置</li>
                                    </li>
                                    <li class="active">套餐查询</li>
                                </ul><!-- .breadcrumb -->
                            </div>

                            <div class="widget-body">
                                <div class="widget-main">
                                    <form class="form-search" id="searchForm">
                                        <div class="row">
                                            <div class="col-xs-16 col-sm-10">
                                                <div class="input-group">
                                                    <span class="ml20">套餐内容：<input  type="text" name="title" /></span>
##                                                    <span class="ml20">&nbsp;&nbsp;&nbsp;领取方式：
##                                                        <select  style="width: 150px;" name="">
##                                                            <option value="common" >普通红包</option>
##                                                        </select>
##                                                    </span>
                                                    <span class="input-group-btn">
                                                        <input class="btn_searchA ml20" type="button" id="searchBut" value="搜索"/>
                                                    </span>
                                                    &nbsp;&nbsp;&nbsp;&nbsp;
                                                    <span class="input-group-btn">
                                                        <input class="btn_searchA ml20" type="button" id="combosubmitBut"  aria-hidden="true" data-dismiss="modal" value="确定"/>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div>&nbsp</div>
                        <div class="BoxStyleA">
                            <div class="BoxStyleATop">
                                <span class="fl">套餐列表</span>
                            </div>
                            <table id="HBTable" class="table table-striped table-bordered table-hover">
                                <thead>
                                <tr>
                                    <th class="center">
                                        <label>
                                        #*<input type="checkbox" class="ace" />*#
                                            <span class="lbl"></span>
                                        </label>
                                    </th>
                                    <th>套餐内容</th>
                                    <th>价格</th>
                                    <th>规格/数量</th>
                                    <th>小计</th>
                                </tr>
                                </thead>
                                <tbody id="tbContainer">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" charset="utf-8" src="${rc.contextPath}/media/js/admin/goods/goods.js"></script>
<script type="text/javascript">
    //实例化编辑器
    //建议使用工厂方法getEditor创建和引用编辑器实例，如果在某个闭包下引用该编辑器，直接调用UE.getEditor('editor')就能拿到相关的实例
    //    var ue = UE.getEditor('editor');

//    var orderDetailEditor = new baidu.editor.ui.Editor();
//    orderDetailEditor.render("orderDetailEditor");

    var purchaseNotesEditor = new baidu.editor.ui.Editor();
    purchaseNotesEditor.render("purchaseNotesEditor");

    var goodsDetailEditor = new baidu.editor.ui.Editor();
    goodsDetailEditor.render("goodsDetailEditor");

//    createToken('uf');

    function getName(element, className) {
        var name = element.value;
        var pos = name.lastIndexOf("\\");
        var str = name.substring(pos + 1);

        $('.' + className).html(str);
    }

</script>